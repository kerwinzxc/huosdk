$(function(){var o=!1,r=!1,a=!1,n=$(window).height(),e=n-$(".userInfo").height()-$(".tab_nav3").height()-56;$(".wrapper").height(n),$(".lt_bar_main").height(e),$(".public_popup_close").click(function(){$("#selectPayPop").fadeOut()}),$(".see_icon").on("click",function(){"text"==$(".login_pwd").attr("type")?($(".login_pwd").attr("type","password"),$(this).removeClass("see_close_icon")):($(this).addClass("see_close_icon"),$(".login_pwd").attr("type","text"))}),$("#comment_like ,#comment_shits").click(function(){return window.indexLogin.commentOpen(window.commentUrl),$("#comment").hide(),!1}),$("#comment_refuse").click(function(){$("#comment").fadeOut()}),$(document).on("click","#service_adv_img",function(){var n=$(this).data("gameurl");window.location.href=n}),$("#signBtn").click(function(){$("#signPhoneWinpop").show(),$("#loginWinpop").hide()}),$(".BackLogin").click(function(){$("#signPhoneWinpop").hide(),$("#loginWinpop").show()}),$("#UserResgister").click(function(){$("#signPhoneWinpop").hide(),$("#signUserWinpop").show()}),$(".BackLoginUser").click(function(){$("#signUserWinpop").hide(),$("#loginWinpop").show()}),$("#signPhoneBtn").click(function(){$("#signUserWinpop").hide(),$("#signPhoneWinpop").show()}),$("#findPwdBtn").click(function(){$("#findPwdWinpop").show(),$("#loginWinpop").hide()}),$("#findPwdBack").click(function(){$("#findPwdWinpop").hide(),$("#loginWinpop").show()}),$("#closepay").click(function(){$("#payframe iframe").prop("src",""),$("#payframe").hide(),$(".gray").hide(),$("#gameframe").show(),window.parent.sdkModule.UserClosepay()}),$("#weixinpay_close").click(function(){window.parent.sdkModule.WechatPay_close()}),$("#closeWindowView").click(function(){$("#Netframe iframe").prop("src",""),$("#gameframe").show(),$("#userInfoDiv").show(),$("#loginWinpop").show(),$("#Netframe").css("z-index","1000"),$("#Netframe").hide()}),$("#gzGzgA").click(function(n){n.stopPropagation(),$("#gz_winpop,.gray").show()}),$(".rt_bar_refresh").click(function(n){n.stopPropagation(),location.reload()}),$(".service_close").click(function(n){n.stopPropagation(),$("#gz_winpop,.gray").hide()}),$(".rt_bar_home").click(function(){window.parent.sdkModule.SDKLogout()}),$(".service_close").click(function(n){n.stopPropagation(),$(".service_winpop_new,.gray").hide()}),$("#frameGame").css("height",$(window).height()),$("#frameGame").css("width",$(document.body).width());var d=60;function l(n,e){60!=d&&"continue"!=e||n.hide().after("<span></span>"),d--,n.next("span").text("重新获取 "+d+" 秒");var i=setTimeout(function(){l(n)},1e3);d<=0&&(n.show().next("span").remove(),clearTimeout(i),d=60)}function c(){$('input[type="text"]').val(""),$('input[type="password"]').val(""),$(".error").html("")}function h(n){return/^1(3[0-9]|4[57]|5[0-35-9]|7[0135678]|8[0-9])\d{8}/i.test(n)}function p(n){$("#noticeDiv").html(n),$("#noticeDiv").show(),$("#noticeDiv").delay(2e3).fadeOut()}$(".no_tab").click(function(){var n=$(".no_tab").index($(this));$(".no_tab").removeClass("this"),$(this).addClass("this"),$(".no_con").hide(),$(".no_con").eq(n).show()}),$("#winpop3CancelJump").click(function(){$("#winpop3").hide()}),$(".winpop_close").click(function(){$(this).parent(".user_winpop").hide(),$(".gray").hide()}),$("#closeGzBtn2").click(function(){$("#gzGzgDiv").hide(),$(".pc_thisWinPop_close").hide(),$(".gray").hide()}),$("#task_kown_btn").click(function(){var n=$(this).attr("data-url");""!=n&&(location.href=n),$("#task_notice").hide(),$(".gray").hide()}),$("#rtBarImg").click(function(){$("#conDiv").removeClass("fadeInLeft").addClass("fadeOutLeft").fadeOut(),$(".lt_bar").hide(),$("#ballConDiv").show(),SuspendedBall.ShowBall()}),$("#ballUserInfoA").click(function(){$(".lt_bar").hide(),$("#ballUserinfoDiv").show()}),$("#goBackConA").click(function(){$("#ballUserinfoDiv").hide(),$("#ballConDiv").show()}),$("#chgOldPwdBackA").click(function(){$("#chgOldPwdDiv").hide(),c(),$("#ballUserinfoDiv").show()}),$("#chgOldPwdA").click(function(){$.ajax({url:"/float.php/mobile/password/pwdconfirm_post",data:{action:sessionStorage.getItem("gn_h5_token_"+window.parent.sdkModule.appid)},type:"POST",dataType:"json",cache:!1,success:function(n){console.log(n),0==n.status?(p("网络错误请重新打开页面"),$("#chgOldPwdDiv").hide(),c(),$("#ballUserinfoDiv").show()):sessionStorage.setItem("gn_h5_uppwdtoken_"+window.parent.sdkModule.appid,n.msg)},error:function(){p("网络错误请重新打开页面"),$("#chgOldPwdDiv").hide(),c(),$("#ballUserinfoDiv").show()}}),$("#ballUserinfoDiv").hide(),$("#chgOldPwdDiv").show(),c();var n=$.trim($("#chgOldPwd_oldpassword").attr("data-vm"));""!=n&&$("#chgOldPwd_oldpassword").val(n).attr("type","text")}),$("#chgOldPwdOper").click(function(){if(!0===o)return p("操作频繁"),!1;var n=$.trim($("#chgOldPwd_oldpassword").val()),e=$.trim($("#chgOldPwd_password").val()),i=$.trim($("#chgOldPwd_repassword").val());return""===n?(p("旧密码未填写"),!1):""===e?(p("新密码未填写"),!1):e.length<6||16<e.length?(p("密码最少6位，最长16位"),!1):1!=new RegExp(/^[a-zA-Z0-9]{6,16}$/g).test(e)?(p("密码必须为数字或字母"),!1):/[\u4E00-\u9FA5]/i.test(e)?(p("不支持中文的密码哦 "),!1):e!=i?(p("两次输入新密码不一致"),!1):(o=!0,void $.ajax({url:"/float.php/mobile/password/pwduph5_post",data:{oldpwd:n,newpwd:e,verifypwd:i,action:sessionStorage.getItem("gn_h5_uppwdtoken_"+window.parent.sdkModule.appid)},type:"POST",dataType:"json",cache:!1,success:function(n){o=!1,"success"==n.state?(p("修改成功,正在返回平台登录..."),setTimeout(window.parent.sdkModule.SDKLogout(),1e3)):(p(n.info),location.reload())},error:function(){console.log("uppwd请求错误"),p("服务器错误,请稍后重试"),o=!1}}))}),$(".user_all_gift_list").on("click","dl dd a",function(){if(window.parent.sdkModule.appid&&window.parent.sdkModule.LoginUserid){var e=$(this),n=e.parent().parent().attr("gift-id"),i=window.parent.sdkModule.appid;console.log("领取礼包"+i+"-"+n),$.ajax({url:"/float.php/mobile/gift/ajaxgifth5",type:"post",data:{giftid:n,app_id:i},async:!1,success:function(n){console.log(n),"1"==n.status?(p(n.info),e.parent().parent().remove(),SuspendedBallContent.init()):"2"==n.status?(p(n.info),e.parent().parent().remove(),SuspendedBallContent.init()):p("请求异常")},error:function(){p("网络连接错误")}})}else console.log("初始化参数缺失")}),$(".user_my_gift_list").on("click","dl dd a",function(n){var e=new ClipboardJS(n.target);e.on("success",function(n){console.log("复制成功"),p("复制成功")}),e.on("error",function(n){console.log("复制失败"),p("复制失败")})}),$("#account").on("click","",function(n){n.stopPropagation();var e=new ClipboardJS(n.target);e.on("success",function(n){console.log("复制账号成功"),p("复制账号成功")}),e.on("error",function(n){console.log("复制账号失败"),p("复制账号失败")})}),$("#uid").on("click","span",function(n){n.stopPropagation();var e=new ClipboardJS(n.target);e.on("success",function(n){console.log("复制UID成功"),p("复制UID成功")}),e.on("error",function(n){console.log("复制UID失败"),p("复制UID失败")})}),$("#loadAccountSelect").on("click","a",function(n){var e=$(this).html(),i=$("#login_password").val();e.length&&i.length?window.parent.sdkModule.sdkLogin(e,i):p("用户名或密码不能为空"),$("#loadaccountPayDiv").hide(),$(".gray").hide()}),$("#bindPhoneA").click(function(){$("#ballUserinfoDiv").hide(),$("#bindPhoneDiv").show(),c()}),$("#bindPhoneB").click(function(){$("#ballUserinfoDiv").hide(),$("#bindPhoneDiv").show(),c()}),$("#bindPhoneOper").click(function(){var n=$.trim($("#bindPhone_phone").val()),e=$.trim($("#bindPhone_code").val()),i=$.trim($("#bindPhone_phone_old").val()),o=$("#bindPhone_phone_old").attr("is_bind_phone");return""===n?(p("手机号未填写"),!1):h(n)&&11==n.length?1!=o||h(i)&&11==i.length?""===e?(p("手机验证码未填"),!1):void window.parent.sdkModule.update_bindmobile(n,i,e):(p("请输入正确的原手机号"),!1):(p("请输入正确手机号"),!1)}),$("#bindPhoneBackA").click(function(){$("#bindPhoneDiv").hide(),c(),$("#ballConDiv").show()}),$("#changeUser").click(function(){$(".gray").css("z-index","1000"),$("#userInfoDiv").css("z-index","1001"),$("#userInfoDiv,.gray").show(),$("#CloseUserIcon").addClass("close")}),$("#CloseUserIcon").click(function(){$(".gray").css("z-index",""),$("#userInfoDiv").css("z-index",""),$("#userInfoDiv,.gray").hide(),$("#CloseUserIcon").removeClass("close")}),$(".close").click(function(){$("#userInfoDiv,.gray").hide()}),$("#bindPhoneCodeGet").click(function(){if(!0===r)return p("操作频繁"),!1;var n=$.trim($("#bindPhone_phone").val()),e=$.trim($("#bindPhone_phone_old").val()),i=$("#bindPhone_phone_old").attr("is_bind_phone");if(""===n)return p("手机号码未填写"),!1;if(!h(n)||11!=n.length)return p("手机号格式不正确"),!1;if(1==i&&(!h(e)||11!=e.length))return p("原手机号格式不正确"),!1;var o=$(this);r=!0;var t=new Date,a=Date.parse(t).toString().substr(0,10),c=n+"_"+t.getFullYear()+t.getMonth()+t.getDate(),s=sessionStorage.getItem(c);console.log("bindmobile:"+c+"|"+s),null!=s?60<=a-s?(d=60,sessionStorage.setItem(c,a),window.parent.sdkModule.send_sms_ph(n),console.log("发送短信到"+n),l(o)):(d=a-s,console.log("短信未过期"),p("短信未过期"),l(o,"continue")):(d=60,sessionStorage.setItem(c,a),send_sms_ph(n),console.log("发送短信到"+n),l(o))}),$("#bindRealnameA").click(function(){$("#ballUserinfoDiv").hide(),$("#bindRealnameDiv").show(),c()}),$("#bindRealnameOper").click(function(){if(!0===a)return!1;var n,e,i=$.trim($("#bind_realname").val()),o=$.trim($("#bind_idcard").val()),t=0;if(0==(""!=$.trim($("#bind_realname").val())||(p("请输入真实姓名"),!1))?t++:0==(n=$.trim($("#bind_idcard").val()),e=checkCard(n),!(""==n||!e)||(p("请使用真实身份信息认证"),!1))&&t++,0<t)return!1;$.ajax({url:"/bind-idcard/bind-idcard",data:{realname:i,idcard:o},type:"post",dataType:"json",cache:!1,success:function(n){a=!1,0==n.status&&p(n.msg),1==n.status&&(c(),$("#bindRealnameLiNo").hide(),$("#bindRealnameLiOk").show(),$("#bindRealnameDiv").hide(),$("#ballUserinfoDiv").show(),$(".shiming").show(),p("认证成功"))}})}),$("#bindRealnameBackA").click(function(){$("#bindRealnameDiv").hide(),c(),$("#ballUserinfoDiv").show()}),$(".tips_pay_close").click(function(){$("#pay-tip").hide()}),$(document).on("click","#logout_btn",function(){$.ajax({url:"/login/out",async:!1}),window.location.reload()});var i={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};checkCard=function(n){return""!==n&&!1!==isCardNo(n)&&!1!==checkProvince(n)&&!1!==checkBirthday(n)&&!1!==checkParity(n)},isCardNo=function(n){return!1!==/(^\d{15}$)|(^\d{17}(\d|X)$)/.test(n)},checkProvince=function(n){var e=n.substr(0,2);return null!=i[e]},checkBirthday=function(n){var e,i=n.length;if("15"!=i)return"18"==i&&(o=(e=n.match(/^(\d{6})(\d{4})(\d{2})(\d{2})(\d{3})([0-9]|X)$/))[2],t=e[3],a=e[4],c=new Date(o+"/"+t+"/"+a),verifyBirthday(o,t,a,c));var o=(e=n.match(/^(\d{6})(\d{2})(\d{2})(\d{2})(\d{3})$/))[2],t=e[3],a=e[4],c=new Date("19"+o+"/"+t+"/"+a);return verifyBirthday("19"+o,t,a,c)},verifyBirthday=function(n,e,i,o){var t=(new Date).getFullYear();if(o.getFullYear()!=n||o.getMonth()+1!=e||o.getDate()!=i)return!1;var a=t-n;return 17<=a&&a<=100},checkParity=function(n){if("18"!=(n=changeFivteenToEighteen(n)).length)return!1;var e,i=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],o=0;for(e=0;e<17;e++)o+=n.substr(e,1)*i[e];return["1","0","X","9","8","7","6","5","4","3","2"][o%11]==n.substr(17,1)},changeFivteenToEighteen=function(n){if("15"!=n.length)return n;var e,i=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],o=0;for(n=n.substr(0,6)+"19"+n.substr(6,n.length-6),e=0;e<17;e++)o+=n.substr(e,1)*i[e];return n+=["1","0","X","9","8","7","6","5","4","3","2"][o%11]}});